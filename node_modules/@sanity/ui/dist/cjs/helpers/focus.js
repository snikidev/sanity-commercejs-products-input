"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.focusLastDescendant = exports.focusFirstDescendant = exports.attemptFocus = exports.isFocusable = void 0;
var element_1 = require("./element");
// export const globalFocusState = {
//   IgnoreUtilFocusChanges: false,
// }
function isFocusable(element) {
    if (element.tabIndex > 0 ||
        (element.tabIndex === 0 && element.getAttribute('tabIndex') !== null)) {
        return true;
    }
    if (element_1.isHTMLAnchorElement(element)) {
        return Boolean(element.href) && element.rel !== 'ignore';
    }
    if (element_1.isHTMLInputElement(element)) {
        return element.type !== 'hidden' && element.type !== 'file' && !element.disabled;
    }
    if (element_1.isHTMLButtonElement(element) ||
        element_1.isHTMLSelectElement(element) ||
        element_1.isHTMLTextAreaElement(element)) {
        return !element.disabled;
    }
    return false;
}
exports.isFocusable = isFocusable;
function attemptFocus(element) {
    if (!isFocusable(element)) {
        return false;
    }
    // globalFocusState.IgnoreUtilFocusChanges = true
    try {
        element.focus();
    }
    catch (_) {
        // ignore
    }
    // globalFocusState.IgnoreUtilFocusChanges = false
    return document.activeElement === element;
}
exports.attemptFocus = attemptFocus;
function focusFirstDescendant(element) {
    for (var i = 0; i < element.childNodes.length; i++) {
        var child = element.childNodes[i];
        if (element_1.isHTMLElement(child) && (attemptFocus(child) || focusFirstDescendant(child))) {
            return true;
        }
    }
    return false;
}
exports.focusFirstDescendant = focusFirstDescendant;
function focusLastDescendant(element) {
    for (var i = element.childNodes.length - 1; i >= 0; i--) {
        var child = element.childNodes[i];
        if (element_1.isHTMLElement(child) && (attemptFocus(child) || focusLastDescendant(child))) {
            return true;
        }
    }
    return false;
}
exports.focusLastDescendant = focusLastDescendant;
//# sourceMappingURL=focus.js.map