"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = Navbar;

var _classnames = _interopRequireDefault(require("classnames"));

var _react = _interopRequireWildcard(require("react"));

var _configSanity = _interopRequireDefault(require("config:sanity"));

var _composeIcon = _interopRequireDefault(require("part:@sanity/base/compose-icon"));

var _hamburgerIcon = _interopRequireDefault(require("part:@sanity/base/hamburger-icon"));

var _router = require("part:@sanity/base/router");

var _searchIcon = _interopRequireDefault(require("part:@sanity/base/search-icon"));

var _default = _interopRequireDefault(require("part:@sanity/components/buttons/default"));

var _tooltip = require("part:@sanity/components/tooltip");

var sidecar = _interopRequireWildcard(require("part:@sanity/default-layout/sidecar?"));

var _toolSwitcher = _interopRequireDefault(require("part:@sanity/default-layout/tool-switcher"));

var _components = require("../components");

var _spaces = require("../util/spaces");

var _Branding = _interopRequireDefault(require("./branding/Branding"));

var _LoginStatus = _interopRequireDefault(require("./loginStatus/LoginStatus"));

var _SanityStatusContainer = _interopRequireDefault(require("./studioStatus/SanityStatusContainer"));

var _presenceMenu = require("./presenceMenu");

var _SearchContainer = _interopRequireDefault(require("./search/SearchContainer"));

var _Navbar = _interopRequireDefault(require("./Navbar.css"));

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var TOUCH_DEVICE = ('ontouchstart' in document.documentElement); // eslint-disable-next-line complexity

function Navbar(props) {
  var createMenuIsOpen = props.createMenuIsOpen,
      onCreateButtonClick = props.onCreateButtonClick,
      onToggleMenu = props.onToggleMenu,
      onSwitchTool = props.onSwitchTool,
      onUserLogout = props.onUserLogout,
      onSearchOpen = props.onSearchOpen,
      onSearchClose = props.onSearchClose,
      onSetLoginStatusElement = props.onSetLoginStatusElement,
      onSetSearchElement = props.onSetSearchElement,
      router = props.router,
      tools = props.tools,
      searchIsOpen = props.searchIsOpen,
      showLabel = props.showLabel,
      showToolMenu = props.showToolMenu;
  var rootState = _spaces.HAS_SPACES && router.state.space ? {
    space: router.state.space
  } : {};
  var className = (0, _classnames.default)(_Navbar.default.root, showToolMenu && _Navbar.default.withToolMenu);
  var searchClassName = (0, _classnames.default)(_Navbar.default.search, searchIsOpen && _Navbar.default.searchIsOpen);
  return /*#__PURE__*/_react.default.createElement("div", {
    className: className,
    "data-search-open": searchIsOpen
  }, /*#__PURE__*/_react.default.createElement("div", {
    className: _Navbar.default.hamburger
  }, /*#__PURE__*/_react.default.createElement(_default.default, {
    "aria-label": "Open menu",
    icon: _hamburgerIcon.default,
    kind: "simple",
    onClick: onToggleMenu,
    padding: "small",
    title: "Open menu",
    tone: "navbar"
  })), /*#__PURE__*/_react.default.createElement("div", {
    className: _Navbar.default.branding
  }, /*#__PURE__*/_react.default.createElement(_router.StateLink, {
    state: rootState,
    className: _Navbar.default.brandingLink
  }, /*#__PURE__*/_react.default.createElement(_Branding.default, {
    projectName: _configSanity.default && _configSanity.default.project.name
  }))), _spaces.HAS_SPACES && /*#__PURE__*/_react.default.createElement("div", {
    className: _Navbar.default.datasetSelect
  }, /*#__PURE__*/_react.default.createElement(_components.DatasetSelect, {
    isVisible: showToolMenu,
    tone: "navbar"
  })), /*#__PURE__*/_react.default.createElement("div", {
    className: _Navbar.default.createButton
  }, /*#__PURE__*/_react.default.createElement(_tooltip.Tooltip, {
    disabled: TOUCH_DEVICE,
    content: /*#__PURE__*/_react.default.createElement("span", {
      className: _Navbar.default.createButtonTooltipContent
    }, "Create new document"),
    tone: "navbar"
  }, /*#__PURE__*/_react.default.createElement("div", null, /*#__PURE__*/_react.default.createElement(_default.default, {
    "aria-label": "Create",
    icon: _composeIcon.default,
    kind: "simple",
    onClick: onCreateButtonClick,
    padding: "small",
    selected: createMenuIsOpen,
    tone: "navbar"
  })))), /*#__PURE__*/_react.default.createElement("div", {
    className: searchClassName,
    ref: onSetSearchElement
  }, /*#__PURE__*/_react.default.createElement("div", null, /*#__PURE__*/_react.default.createElement(_SearchContainer.default, {
    shouldBeFocused: searchIsOpen,
    onOpen: onSearchOpen,
    onClose: onSearchClose
  }))), /*#__PURE__*/_react.default.createElement("div", {
    className: _Navbar.default.toolSwitcher
  }, tools.length > 1 && /*#__PURE__*/_react.default.createElement(_toolSwitcher.default, {
    direction: "horizontal",
    isVisible: showToolMenu,
    tools: tools,
    activeToolName: router.state.tool,
    onSwitchTool: onSwitchTool,
    router: router,
    showLabel: showLabel,
    tone: "navbar"
  })), /*#__PURE__*/_react.default.createElement("div", {
    className: _Navbar.default.extras
  }), /*#__PURE__*/_react.default.createElement("div", {
    className: _Navbar.default.sanityStatus
  }, /*#__PURE__*/_react.default.createElement(_SanityStatusContainer.default, null)), sidecar && sidecar.isSidecarEnabled && sidecar.isSidecarEnabled() && /*#__PURE__*/_react.default.createElement("div", {
    className: _Navbar.default.helpButton
  }, sidecar && /*#__PURE__*/(0, _react.createElement)(sidecar.SidecarToggleButton)), /*#__PURE__*/_react.default.createElement("div", {
    className: _Navbar.default.presenceStatus
  }, /*#__PURE__*/_react.default.createElement(_presenceMenu.PresenceMenu, null)), /*#__PURE__*/_react.default.createElement("div", {
    className: _Navbar.default.loginStatus,
    ref: onSetLoginStatusElement
  }, /*#__PURE__*/_react.default.createElement(_LoginStatus.default, {
    onLogout: onUserLogout
  })), /*#__PURE__*/_react.default.createElement("div", {
    className: _Navbar.default.searchButton
  }, /*#__PURE__*/_react.default.createElement(_default.default, {
    icon: _searchIcon.default,
    kind: "simple",
    onClick: onSearchOpen,
    padding: "small",
    tone: "navbar"
  })));
}